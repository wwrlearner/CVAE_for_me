GMVAE (
  (x_encoder): EncoderRNN(
    (input_dropout): Dropout(p=0, inplace=False)
    (rnn): GRU(100, 64, batch_first=True, dropout=0.3, bidirectional=True)
  ), parameters=63744
  (decoder): DecoderRNN(
    (input_dropout): Dropout(p=0.3, inplace=False)
    (rnn): GRU(64, 64, batch_first=True, dropout=0.3)
    (project): Linear(in_features=64, out_features=2, bias=True)
  ), parameters=25090
  (q_y_mean): Linear(in_features=128, out_features=10, bias=True), parameters=1290
  (q_y_logvar): Linear(in_features=128, out_features=10, bias=True), parameters=1290
  (post_c): Sequential (
    (0): Linear(in_features=128, out_features=128, bias=True), weights=((128, 128), (128,)), parameters=16512
    (1): ReLU(), weights=(), parameters=0
    (2): Linear(in_features=128, out_features=40, bias=True), weights=((40, 128), (40,)), parameters=5160
  ) Total Parameters=21672, parameters=21672
  (dec_init_connector): LinearConnector(
    (linear): Linear(in_features=10, out_features=64, bias=False)
  ), parameters=640
  (firing_rate): Linear(in_features=2, out_features=100, bias=True), parameters=300
  (cat_connector): GumbelConnector(), parameters=0
  (mse_loss): TimeSeriesLossMSE(
    (mse_loss): MSELoss()
  ), parameters=0
  (cat_kl_loss): CatKLLoss(), parameters=0
) Total Parameters=114026
**** Training Begins ****
**** Epoch 0/50 ****
Flush previous valid loss
Recovering the learning rate to 0.001
Load previous best model
500/2000-(0.000): Train nll 14355.950 PPL inf agg_ckl 0.246 mi 0.001 zkl 0.085 dispersion 4.853 real_zkl 4.938 real_ckl 0.247 elbo 14361.135 param_var 33.133
1000/2000-(0.000): Train nll 14357.158 PPL inf agg_ckl 0.139 mi 0.000 zkl 0.001 dispersion 1.423 real_zkl 1.424 real_ckl 0.139 elbo 14358.721 param_var 8.392
1500/2000-(0.000): Train nll 14357.042 PPL inf agg_ckl 0.042 mi 0.000 zkl 0.000 dispersion 0.315 real_zkl 0.316 real_ckl 0.042 elbo 14357.399 param_var 2.010
2000/2000-(0.000): Train nll 14352.615 PPL inf agg_ckl 0.000 mi 0.000 zkl 0.000 dispersion 0.015 real_zkl 0.016 real_ckl 0.000 elbo 14352.631 param_var 0.103

=== Evaluating Model ===
Train nll 14355.691 PPL inf agg_ckl 0.107 mi 0.000 zkl 0.022 dispersion 1.652 real_zkl 1.673 real_ckl 0.107 elbo 14357.472 param_var 10.910
Valid nll 1782.278 PPL inf agg_ckl 0.001 mi 0.000 zkl 0.128 dispersion 0.001 real_zkl 0.129 real_ckl 0.001 elbo 1782.408 param_var 0.006
Total valid loss 1782.408203125
Update patience to 10
Model Saved.

**** Epoch 1/50 ****
499/2000-(0.000): Train nll 14352.781 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14352.781 param_var 0.001
999/2000-(0.000): Train nll 14352.854 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion -0.000 real_zkl 0.000 real_ckl 0.000 elbo 14352.854 param_var 0.000
1499/2000-(0.000): Train nll 14350.779 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion -0.000 real_zkl 0.000 real_ckl 0.000 elbo 14350.779 param_var 0.000
1999/2000-(0.000): Train nll 14351.764 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion -0.000 real_zkl 0.000 real_ckl 0.000 elbo 14351.764 param_var 0.000

=== Evaluating Model ===
Train nll 14352.045 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14352.045 param_var 0.000
Valid nll 1786.739 PPL inf agg_ckl 0.000 mi 0.000 zkl 0.062 dispersion 0.000 real_zkl 0.062 real_ckl 0.000 elbo 1786.801 param_var 0.000
Total valid loss 1786.800801595052

**** Epoch 2/50 ****
498/2000-(0.000): Train nll 14352.536 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion -0.000 real_zkl 0.000 real_ckl 0.000 elbo 14352.536 param_var 0.000
998/2000-(0.000): Train nll 14351.744 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion -0.000 real_zkl 0.000 real_ckl 0.000 elbo 14351.744 param_var 0.000
1498/2000-(0.000): Train nll 14352.796 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion -0.000 real_zkl 0.000 real_ckl 0.000 elbo 14352.796 param_var 0.000
1998/2000-(0.000): Train nll 14350.573 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion -0.000 real_zkl 0.000 real_ckl 0.000 elbo 14350.573 param_var 0.000

=== Evaluating Model ===
Train nll 14351.912 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion -0.000 real_zkl 0.000 real_ckl 0.000 elbo 14351.912 param_var 0.000
Valid nll 1794.172 PPL inf agg_ckl 0.000 mi 0.000 zkl 0.048 dispersion 0.000 real_zkl 0.048 real_ckl 0.000 elbo 1794.220 param_var 0.000
Total valid loss 1794.2201741536458
Adjust learning rete to 0.0008

**** Epoch 3/50 ****
497/2000-(0.000): Train nll 14348.143 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14348.143 param_var -0.000
997/2000-(0.000): Train nll 14355.039 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion -0.000 real_zkl 0.000 real_ckl 0.000 elbo 14355.039 param_var 0.000
1497/2000-(0.000): Train nll 14350.752 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion -0.000 real_zkl 0.000 real_ckl 0.000 elbo 14350.752 param_var 0.000
1997/2000-(0.000): Train nll 14352.063 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion -0.000 real_zkl 0.000 real_ckl 0.000 elbo 14352.063 param_var 0.000

=== Evaluating Model ===
Train nll 14351.499 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion -0.000 real_zkl 0.000 real_ckl 0.000 elbo 14351.499 param_var 0.000
Valid nll 1795.317 PPL inf agg_ckl 0.000 mi 0.000 zkl 0.046 dispersion -0.000 real_zkl 0.046 real_ckl 0.000 elbo 1795.363 param_var 0.000
Total valid loss 1795.363016764323
Adjust learning rete to 0.00064

**** Epoch 4/50 ****
496/2000-(0.000): Train nll 14354.211 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14354.211 param_var -0.000
996/2000-(0.000): Train nll 14349.890 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion -0.000 real_zkl 0.000 real_ckl 0.000 elbo 14349.890 param_var 0.000
1496/2000-(0.000): Train nll 14352.095 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion -0.000 real_zkl 0.000 real_ckl 0.000 elbo 14352.095 param_var 0.000
1996/2000-(0.000): Train nll 14350.661 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion -0.000 real_zkl 0.000 real_ckl 0.000 elbo 14350.661 param_var -0.000

=== Evaluating Model ===
Train nll 14351.714 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14351.714 param_var -0.000
Valid nll 1787.683 PPL inf agg_ckl 0.000 mi 0.000 zkl 0.037 dispersion -0.000 real_zkl 0.037 real_ckl 0.000 elbo 1787.720 param_var -0.000
Total valid loss 1787.720438639323
Adjust learning rete to 0.0005120000000000001

**** Epoch 5/50 ****
495/2000-(0.000): Train nll 14353.358 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14353.358 param_var -0.000
995/2000-(0.000): Train nll 14349.157 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14349.157 param_var -0.000
1495/2000-(0.000): Train nll 14353.699 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14353.699 param_var -0.000
1995/2000-(0.000): Train nll 14351.664 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14351.664 param_var -0.000

=== Evaluating Model ===
Train nll 14351.970 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14351.970 param_var -0.000
Valid nll 1786.533 PPL inf agg_ckl 0.000 mi 0.000 zkl 0.032 dispersion -0.000 real_zkl 0.032 real_ckl 0.000 elbo 1786.565 param_var 0.000
Total valid loss 1786.5651041666667
Adjust learning rete to 0.0004096000000000001

**** Epoch 6/50 ****
494/2000-(0.000): Train nll 14349.564 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14349.564 param_var -0.000
994/2000-(0.000): Train nll 14350.977 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14350.977 param_var -0.000
1494/2000-(0.000): Train nll 14351.405 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14351.405 param_var -0.000
1994/2000-(0.000): Train nll 14350.871 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14350.871 param_var -0.000

=== Evaluating Model ===
Train nll 14350.704 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14350.704 param_var -0.000
Valid nll 1790.956 PPL inf agg_ckl 0.000 mi 0.000 zkl 0.041 dispersion -0.000 real_zkl 0.041 real_ckl 0.000 elbo 1790.996 param_var -0.000
Total valid loss 1790.9964192708333
Adjust learning rete to 0.0003276800000000001

**** Epoch 7/50 ****
493/2000-(0.000): Train nll 14350.735 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14350.735 param_var -0.000
993/2000-(0.000): Train nll 14350.283 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14350.283 param_var -0.000
1493/2000-(0.000): Train nll 14352.902 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14352.902 param_var -0.000
1993/2000-(0.000): Train nll 14353.457 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14353.457 param_var -0.000

=== Evaluating Model ===
Train nll 14351.845 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14351.845 param_var -0.000
Valid nll 1802.511 PPL inf agg_ckl 0.000 mi 0.000 zkl 0.034 dispersion -0.000 real_zkl 0.034 real_ckl 0.000 elbo 1802.546 param_var -0.000
Total valid loss 1802.5455322265625
Adjust learning rete to 0.0002621440000000001

**** Epoch 8/50 ****
492/2000-(0.000): Train nll 14349.806 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14349.806 param_var -0.000
992/2000-(0.000): Train nll 14352.675 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14352.675 param_var -0.000
1492/2000-(0.000): Train nll 14349.390 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14349.390 param_var -0.000
1992/2000-(0.000): Train nll 14356.122 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14356.122 param_var -0.000

=== Evaluating Model ===
Train nll 14351.998 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14351.998 param_var -0.000
Valid nll 1778.872 PPL inf agg_ckl 0.000 mi 0.000 zkl 0.034 dispersion 0.000 real_zkl 0.034 real_ckl 0.000 elbo 1778.907 param_var -0.000
Total valid loss 1778.906514485677
Model Saved.

**** Epoch 9/50 ****
491/2000-(0.000): Train nll 14353.451 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14353.451 param_var -0.000
991/2000-(0.000): Train nll 14355.633 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14355.633 param_var -0.000
1491/2000-(0.000): Train nll 14354.620 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14354.620 param_var -0.000
1991/2000-(0.000): Train nll 14350.568 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14350.568 param_var -0.000

=== Evaluating Model ===
Train nll 14353.568 PPL inf agg_ckl 0.000 mi -0.000 zkl 0.000 dispersion 0.000 real_zkl 0.000 real_ckl 0.000 elbo 14353.568 param_var -0.000
Valid nll 1795.317 PPL inf agg_ckl 0.000 mi 0.000 zkl 0.031 dispersion 0.000 real_zkl 0.031 real_ckl 0.000 elbo 1795.347 param_var 0.000
Total valid loss 1795.3473510742188
!!Early stop due to run out of patience!!
Best validation loss 1778.906514
Test nll 1775.865 PPL inf agg_ckl 0.000 mi 0.000 zkl 0.034 dispersion 0.000 real_zkl 0.034 real_ckl 0.000 elbo 1775.900 param_var -0.000
Total valid loss 1775.8995361328125
Find MI for: 4 batches
